## Классификация фильмов по уровню английского языка.

Интересный проект мастерской Яндекса! Предлагается изучить возможность создания приложения - которое будет определять уровень сложности английского языка в фильме и соответсвенно 
пользователь, который изучает английский язык или владеет им на определеном уровне, сможет подобрать себе фильм который сможет посмотреть на английском языке и понять большую часть.
Есть не очень большое колличество субтитров фильмов и сериалов вручную размеченных экспертом. Сложность варьируется от А2 до С1 ( в оригинале были
другие уровни но я их объеденил). Класс А1 - самый начальный не был представлен, очевидно что с таким уровнем знания языка - рано смотреть фильмы в оригинале,
С2 - профессиональное владение, насколько я изучил информацию нет единого мнения - может ли не носитель языка освоить не родной язык на таком уровне.
В любом случае на этом уровне уже не требуется проверять подходит ли фильм. Уровни определялись экспертом по Оксфордскому словарю , там где эксперт установил несколько уровней 
я оставил тот - который сложнее. Если пользователь посмотрит фильм и ничего не поймет - врятли он останется доволен выбором. 
# https://movie-classification-app-kh5yxwmxwhjedd2gr8ija4.streamlit.app/
На основе ноутбука я создал streamlit приложение. В приложении пользователь вводит название фильма и на выходе получет оченку сложности от А2 до В2. Ограчичения streamlit по ресурсам и 
жесткие лимиты на доступ у популярных сайтов с субтитрами существенно усложнили задачу. Приложение может не найти субтитры даже для популярных фильмов. 

### Структура работы
### 1. Сбор данных
Для начала мы собрали датасет с информацией о фильмах, включая их названия и уровни владения языком, соответствующие этим фильмам. Данные были сохранены в файле movies_labels.xlsx.

### 2. Загрузка и предобработка данных
Загрузка данных:

Проверка наличия файла и его корректное считывание с помощью библиотеки pandas.
Структура данных включала идентификатор фильма (id), название фильма (Movie) и уровень владения языком (Level).
Загрузка субтитров:

Субтитры фильмов были сохранены в отдельной папке, и для каждого фильма выполнялось чтение соответствующего файла субтитров.
Обработка ошибок при чтении файлов (отсутствие файла или ошибки кодировки).
Обработка уровней владения языком:

Нормализация меток уровней, чтобы избежать смешанных значений и дисбаланса классов.
### 3. Предобработка текста
Для подготовки текстовых данных мы использовали несколько шагов предобработки:

Очистка текста:

Удаление HTML-тегов и URL.
Нормализация символов Unicode.
Токенизация текста, удаление стоп-слов и чисел.
Лемматизация токенов с использованием библиотеки spaCy.
Генерация эмбеддингов:

Использование модели Longformer для генерации эмбеддингов текстов субтитров.
Преобразование эмбеддингов в формат, подходящий для обучения моделей машинного обучения.
### 4. Обучение моделей
Разделение данных:

Разделение датасета на обучающую и тестовую выборки.
Кодирование меток:

Кодирование целевой переменной (уровней владения языком) с использованием LabelEncoder.
Обучение моделей:

Подбор гиперпараметров и обучение моделей CatBoost, LGBM и SVC.
Использование ансамбля моделей VotingClassifier для комбинирования предсказаний отдельных моделей.
Оптимизация порога:

С помощью библиотеки Optuna был подобран наилучший порог для классификации, чтобы улучшить метрики F1 для каждого класса.
### 5. Оценка результатов
Классификационный отчет:

Модель достигла следующих результатов на тестовом наборе данных:

Средняя точность: 67%
Средняя полнота: 61%
Средняя F1-мера: 67%

Наилучшие результаты были достигнуты для класса B2, тогда как классы A2 и B1 оказались наиболее сложными для классификации из-за недостатка данных и сложности текстов.

### 6. Веб-приложение
Создано веб-приложение с использованием Streamlit, которое позволяет пользователям определять оптимальный уровень владения языком для просмотра конкретного фильма.

Основные функции приложения:
Ввод названия фильма:

Пользователь вводит официальное англоязычное название фильма.
Загрузка субтитров:

Автоматическая загрузка субтитров для введенного фильма с использованием библиотеки subliminal.
Предобработка текста:

Очистка и лемматизация текста субтитров.
Генерация эмбеддингов:

Генерация эмбеддингов с использованием модели Longformer.
Классификация уровня:

Классификация уровня владения языком с использованием ансамбля моделей VotingClassifier.
Оптимизация порогов для достижения наилучших результатов.
Вывод результата:

Отображение рекомендованного уровня владения языком для просмотра фильма.

### Используемые технологии и библиотеки
- Язык программирования: Python
- Библиотеки для работы с данными: pandas, numpy
- Библиотеки для машинного обучения: lightgbm, catboost, scikit-learn, optuna
- Библиотеки для обработки текста: nltk, spacy, transformers (Longformer)
- Библиотеки для работы с субтитрами: pysubs2, subliminal
- Инструменты для визуализации: matplotlib, plotly
- Инструменты для разворачивания модели: streamlit
- Контакты
- 
### Лицензия
В приложении используется 
OpenSubtitles Wrapper лицензирован под MIT License. Полный текст лицензии можно найти https://github.com/dusking/opensubtitles-com/blob/main/LICENSE
