### Проект: Предсказание возраста по фото.

Цель проекта — используя возможности CV разработать приложение, которое предсказывает возраст человека по фотографии. 
В нашем распоряжении набор из 7590 размеченных фото https://www.kaggle.com/datasets/abhikjha/appa-real-face-cropped/

* ссылка на приложение
 ### clck.ru/3BQ5Et
 
На странице приложения пользователю предлагается загрузить фото, используя соответствующую кнопку 'Browse files'. RetinaFace определяет наличие людей на фото ( детекция по лицу), для каджого найденого человека, с помощью предобученной TinyVit будет предсказан возраст, если человек на фото не найдет - будет выведено соответсвующе сообщение. 
Модель предсказывает возраст в диапазоне и может быть менее точна для детей и пожилых людей (особенности обучения), а так же при полохом качестве фото ( не четком изображении лица на фото).

### Структура работы

#### Загрузка и предобработка данных

Проверка наличия файла и его корректное считывание с помощью библиотеки *pandas*.
Сруктура данных включала идентификатор изображения, путь к файлу изображения и возраст человека на изображении.
Для обработки изображений использовались библиотеки *opencv* и *PIL*.
Изображения были нормализованы и масштабированы до размера 224*224 для подачи в модель.
Аугментация уже присутвует. Сдвиги, повороты, блюры, цветовые преобразования.
Данные были разделены на трейн, валид и тест.

#### Обучение модели

Использовалась предобученная TinyVit от timm (HuggingFace), которая имеет относительно небольшой размер и хорошо зарекомендовала себя в задачах классификации изображений.
Модель обучалась на Kaggle (GPU).
Из за ограничений платформы по использванию ресурсов не удалось подобрать параметры Optuna, все параметры выставлялись и тестировались экспериментально.

Для простоты интерпритации выбрана метрика MAE.

Итоговый результат на тестовой выборке MAE 5.3

Результат возможно сделать лучше:
- ипользование более большой модели ( VitLarge например)
- большой объем размеченных данных
- подбор параметров
- наличие мощных графических ресурсов

#### Стек:
Язык программирования: Python
Библиотеки для работы с данными: pandas, numpy
Библиотеки для машинного обучения: torch, lightning, scikit-learn
Библиотеки для обработки изображений: opencv, PIL
Инструменты для визуализации: matplotlib
Инструменты для разворачивания модели: streamlit

#### Лицензия
В приложении используется технологии RetinaFace. Полный текст лицензии можно найти https://github.com/serengil/retinaface/blob/master/LICENSE. 

Предобученная модель TinyVit https://huggingface.co/timm/tiny_vit_11m_224.dist_in22k_ft_in1k
